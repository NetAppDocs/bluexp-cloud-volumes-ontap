---
sidebar: sidebar
permalink: concept-azure-file-sig-verify.html
keywords: Azure, image, VHD, file signature verification, encryption, sha256, ONTAP, Cloud Volumes, CLI, 
summary: Understanding how to verify an exported VHD file signature through the Cloud Volumes ONTAP 
Image Digest File tool. 
---

= File Signature Verification
:hardbreaks:
:nofooter:
:icons: font
:linkattrs:
:imagesdir: ./media/

[.lead]
The Azure image verification process will generate a digest from the VHD file with the leading 1MB striped by using hash function. To match the signing procedure, SHA256 is used to hash. You need to remove the leading 1MB from the VHD file and then verify the remaining portion of the VHD file. 

== File signature verification workflow summary
The following is an overview of the file signature verification workflow process:

* Download the digest file(.sig), public key certificate file(.pem) and chain certificate file(.pem) from NSS. 
If tar.gz is the downloaded format, an extra step is needed to open it.

* Verify the chain of trust.

* Extract the public key(.pub) from the public key certificate(.pem).

* The extracted public key is used to decrypt the digest file. The result is then compared against a new 
unencrypted digest of the temporary file created from the image file with leading 1MB removed. This step is 
achieved by the following openssl command.

* The general CLI statement appears as follows:
+ 
----
openssl dgst -verify <public_key> -keyform <form> <hash_function> 
-signature <digest_file> -binary <temporary_file>
----

* OpenSSL CLI tool gives a "Verified OK" message if both the files match and "Verification Failure" if they do not match.
+
image:graphic_azure_check_signature.png[An image that shows the file signature verification process]
+
image:screenshot_cloud_volumes_ontap_tar.gz.png[An image that shows the NSS page containing the digest file tar.gz downloads]